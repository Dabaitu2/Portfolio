{"version":3,"file":"static/webpack/static/development/pages/projects/internship.js.36b834fb50b9d187497d.hot-update.js","sources":["webpack:///./components/Projects/ProjectDetail/index.tsx"],"sourcesContent":["import React, { FC, useEffect } from 'react';\nimport styles from './index.module.less';\nimport LazyLoadImg, { LazyLoadImgProps } from '../../common/LazyLoadImg';\nimport { useResizeCallback } from '../../../utils/hooks/useResizeCallback';\nimport { useForceUpdate } from '../../../utils/hooks/useForceUpdate';\nimport throttle from 'lodash/throttle';\nexport interface ProjectDetailInfoProps {\n  images: LazyLoadImgProps[];\n  title: string;\n  desc: string[];\n  tags: string[];\n  details: string;\n  mainColor: string;\n  detail_images_meta: {\n    dir: string;\n    num: number;\n  };\n  links?: {\n    src: string\n    className: string,\n    desc: string\n  }[]\n  video?: [\n    {\n      src: string;\n    }\n  ];\n  affix_image_meta?: {\n    dir: string;\n    num: number;\n  };\n}\n\ntype IProps = ProjectDetailInfoProps;\n\nexport const ProjectDetailItem: FC<IProps> = (props: IProps) => {\n  const {\n    images,\n    title,\n    desc,\n    links,\n    tags,\n    details,\n    mainColor,\n    detail_images_meta,\n    video,\n    affix_image_meta\n  } = props;\n  const videoRef = React.useRef<any>({\n    duration: 0,\n    currentTime: 0,\n    fake: true\n  });\n  const [played, setPlayed] = React.useState<boolean | undefined>(undefined);\n  const [visible, setVisible] = React.useState<boolean>(false);\n  const { forceUpdate } = useForceUpdate();\n  const [progress, setProgress] = React.useState<number>(0);\n  useEffect(() => {\n    if (!videoRef.current.fake && document) {\n      document.onscroll = () => {\n        if (videoRef.current!.getBoundingClientRect().top < 700) {\n          if (played === undefined) {\n            videoRef.current.play();\n            setPlayed(true);\n          }\n        } else if (videoRef.current!.getBoundingClientRect().bottom < 150) {\n          videoRef.current.pause();\n          setPlayed(false);\n        }\n      };\n    }\n  }, [videoRef.current, document, played]);\n  const { addMustExecuteCallback } = useResizeCallback();\n  addMustExecuteCallback(() => {\n    forceUpdate();\n  });\n  useEffect(() => {\n    const handleTimeUpdate = throttle(() => {\n      setProgress(\n        (videoRef.current.currentTime / videoRef.current.duration) * 100\n      );\n    }, 500);\n    if (!videoRef.current.fake) {\n      videoRef.current.addEventListener('timeupdate', handleTimeUpdate);\n    }\n  }, [videoRef.current, setProgress]);\n\n  return (\n    <div\n      className={styles['project-detail-item']}\n      style={{\n        color: mainColor\n      }}\n    >\n      <div className={styles['project-detail-images']}>\n        {images.map(image => (\n          <LazyLoadImg {...image} className={`${styles['project-detail-image']} ${image.className}`} />\n        ))}\n      </div>\n      <div>\n        <div className={styles['project-detail-title']}>{title}</div>\n        <div className={styles['project-detail-subtitle']}>\n          {desc.map(d => (\n            <span>{d}</span>\n          ))}\n        </div>\n      </div>\n      <div\n        className={styles['project-detail-details']}\n        style={{\n          backgroundColor: mainColor\n        }}\n      >\n        <div className={styles['project-detail-tags']}>\n          {tags.map(t => (\n            <span>{t}</span>\n          ))}\n        </div>\n        {details.length > 0 && (\n          <span className={styles['project-detail-details-desc']}>\n            {details}\n          </span>\n        )}\n      </div>\n      <div\n        style={{\n          fontSize: 0\n        }}\n      >\n        {Array.from({ length: detail_images_meta.num }).map((_, i) => {\n          if (i === 0) {\n            return;\n          }\n          const common_file = detail_images_meta.dir + '/' + (i + 1).toString();\n          return (\n            <LazyLoadImg\n              src={common_file + '.jpg'}\n              sources={[\n                {\n                  type: 'image/webp',\n                  src: common_file + '.webp'\n                }\n              ]}\n              preview_src={common_file + '-preview.jpg'}\n              preview_sources={[\n                { type: 'image/webp', src: common_file + '-preview.webp' }\n              ]}\n              className={styles['project-detail-details-images']}\n            />\n          );\n        })}\n        {\n          links && links.map(link => <a className={link.className} href={link.src} target={'blank'}>{link.desc}</a>)\n        }\n        {video\n          ? video.map(v => {\n              return (\n                <div\n                  style={{\n                    width: '1600rem',\n                    position: 'relative',\n                    height: '900rem',\n                    transition: '0.3s ease-in-out',\n                    filter: played == true ? 'none' : 'opacity(0.9)'\n                  }}\n                  onMouseEnter={() => {\n                    setVisible(true);\n                  }}\n                  onMouseLeave={() => {\n                    setVisible(false);\n                  }}\n                  onClick={() => {\n                    if (played) {\n                      videoRef.current.pause();\n                      setPlayed(false);\n                    } else {\n                      videoRef.current.play();\n                      setPlayed(true);\n                    }\n                  }}\n                >\n                  <div\n                    className={styles['project-detail-stop-icon']}\n                    style={{\n                      display: played == true ? 'none' : 'block'\n                    }}\n                  >\n                    PAUSE\n                  </div>\n                  <div\n                    style={{\n                      transition: '.4s ease',\n                      opacity: visible ? 1 : 0\n                    }}\n                    className={styles['project-detail-video-control-bar']}\n                  >\n                    <div className={styles['bar']}>\n                      <div\n                        className={styles['progress']}\n                        style={{\n                          width: progress + '%'\n                        }}\n                      />\n                    </div>\n                  </div>\n                  <video\n                    src={v.src}\n                    ref={videoRef}\n                    autoPlay={false}\n                    style={{\n                      width: '1600rem',\n                      float: 'left'\n                    }}\n                  />\n                </div>\n              );\n            })\n          : null}\n        {affix_image_meta\n          ? Array.from({ length: affix_image_meta.num }).map((_, i) => {\n              if (i === 0) {\n                return;\n              }\n              const common_file =\n                affix_image_meta.dir +\n                '/' +\n                (detail_images_meta.num + i + 1).toString();\n              return (\n                <LazyLoadImg\n                  src={common_file + '.jpg'}\n                  sources={[\n                    {\n                      type: 'image/webp',\n                      src: common_file + '.webp'\n                    }\n                  ]}\n                  preview_src={common_file + '-preview.jpg'}\n                  preview_sources={[\n                    { type: 'image/webp', src: common_file + '-preview.webp' }\n                  ]}\n                  className={styles['project-detail-details-images']}\n                />\n              );\n            })\n          : null}\n      </div>\n    </div>\n  );\n};\n\nexport default ProjectDetailItem;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AA8BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;AACA;AACA;AACA;AAHA;AACA;AAdA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArCA;AAAA;AACA;AAqCA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAMA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AADA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AAAA;AAAA;AAEA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAEA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyBA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AAFA;AAIA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AACA;AACA;AACA;AAFA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAGA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAIA;AAEA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AAAA;AAAA;AAEA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeA;AAKA;AAEA;;;;A","sourceRoot":""}