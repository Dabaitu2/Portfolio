{"ast":null,"code":"var __jsx = React.createElement;\nimport * as React from 'react';\nimport { useEffect, useState } from 'react';\nimport styles from '../index.less';\nimport LayoutHeader from '../../components/LayoutHeader';\nimport { CurrentTabProvider, useCurrentTab } from '../../utils/hooks/useCurrentTab';\nimport { ContentSwitcher } from '../../components/ContentSwitcher';\nimport { useComponentDidMount } from '../../utils/hooks/useComponentDidMount';\nimport { useResizeCallback } from '../../utils/hooks/useResizeCallback';\nimport ProjectDetailItem from '../../components/Projects/ProjectDetail';\nimport Profile from '../../components/Profile';\nimport Projects from '../../components/Projects';\nconst DESIGN_WIDTH = 1920;\nconst COMMON_STATIC_PATH = '/static/images/projectDetails/img';\nconst Info = {\n  title: 'xixi4rhino',\n  mainColor: '#9E0601',\n  desc: ['a website for rhino protection', 'by impacting potential consumers directly'],\n  details: `‘xixi4rhino’ is a website for Rhino Protection, aiming to change Chinese potential consumers’ rhino horns purchase intention and create better Internet information environment about rhino horns. It’s critical to directly impact the consumption intention of Chinese potential consumers and make them abandon the purchase when rhinos are poached for rhino horns. In the Chinese market, as the Internet plays an import role on consumption decision, we created the website with an entrapping name “Rhino Horn Purchase Guide” to induce people to click and browse it. The glitch art video at the beginning contains bloody scene and dialogue box interaction to make potential consumers shocked powerfully. After that, the webpage informs people about the correct knowledge of the rhino horns and encourage them to forward or donate, so that the website could be more widely spread.`,\n  tags: ['Society Innovation | Web UI and UX Design | Team Work in 5 weeks | Mar 2018 '],\n  images: [{\n    src: COMMON_STATIC_PATH + '7.jpg',\n    sources: [{\n      src: COMMON_STATIC_PATH + '7.webp',\n      type: 'image/webp'\n    }],\n    preview_src: COMMON_STATIC_PATH + '7-preview.jpg',\n    preview_sources: [{\n      src: COMMON_STATIC_PATH + '7-preview.webp',\n      type: 'image/webp'\n    }],\n    alt: 'rhino'\n  }],\n  detail_images_meta: {\n    dir: '/static/images/projectDetails/xixi4rhino',\n    num: 7\n  }\n};\nconst menuItems = [{\n  key: 'xixi4rhino',\n  label: 'xixi4rhino'\n}];\n\nconst InnerLayout = () => {\n  const {\n    state: {\n      scale: {\n        scale\n      }\n    },\n    actions: {\n      setScale,\n      setCurrentTab\n    }\n  } = useCurrentTab();\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n\n  const fallBackReactive = () => {\n    setScale(1);\n    const scale = Math.min(document.body.clientWidth / 1920, 1);\n    let metaEl = document.querySelector('meta[name=\"viewport\"]');\n\n    if (!metaEl) {\n      metaEl = document.createElement('meta');\n      metaEl.setAttribute('name', 'viewport');\n      metaEl.setAttribute('content', 'width=device-width, initial-scale=' + scale + ', maximum-scale=' + scale + ', minimum-scale=' + scale + ', user-scalable=no');\n      document.documentElement.firstElementChild.appendChild(metaEl);\n    } else {\n      metaEl.setAttribute('content', 'width=device-width, initial-scale=' + scale + ', maximum-scale=' + scale + ', minimum-scale=' + scale + ', user-scalable=no');\n    }\n\n    window.scrollTo({\n      top: 0\n    });\n  }; // innerWidth 比 body.offsetWidth 稳定\n\n\n  const {\n    IsDone\n  } = useComponentDidMount(() => {\n    setCurrentTab(1);\n\n    if (window.innerWidth >= 700) {\n      const scale = Math.max(Math.min(window.innerWidth / DESIGN_WIDTH, 1), 0.2);\n      setScale(scale);\n    } else {\n      fallBackReactive();\n    }\n\n    addCallback(() => {\n      const scale = Math.max(Math.min(window.innerWidth / DESIGN_WIDTH, 1), 0.2);\n      document.getElementsByTagName('html')[0].style.fontSize = `${scale}px`;\n      window.scrollTo({\n        top: 0\n      });\n      setScale(scale);\n    });\n  });\n  useEffect(() => {\n    setIsLoading(true);\n    document.getElementsByTagName('html')[0].style.fontSize = `${scale}px`;\n    window.scrollTo({\n      top: 0\n    }); // 强行将这次setState推迟到下次处理\n\n    setTimeout(() => {\n      setIsLoading(false);\n    }, 0);\n  }, [scale]);\n  const {\n    addCallback\n  } = useResizeCallback(fallBackReactive);\n  return IsDone && !isLoading ? __jsx(\"div\", {\n    className: styles.layout\n  }, __jsx(LayoutHeader, {\n    menuItems: menuItems\n  }), __jsx(ContentSwitcher, null, __jsx(Profile, null), __jsx(ProjectDetailItem, Info), __jsx(Projects, null)), __jsx(LayoutHeader, {\n    menuItems: menuItems,\n    bodyStyle: {\n      marginTop: '138rem'\n    }\n  })) : null;\n};\n\nconst Layout = () => {\n  return __jsx(CurrentTabProvider, null, __jsx(InnerLayout, null));\n};\n\nexport default Layout;","map":null,"metadata":{},"sourceType":"module"}