{"ast":null,"code":"var __jsx = React.createElement;\nimport * as React from 'react';\nimport styles from '../index.less';\nimport LayoutHeader from '../../components/LayoutHeader';\nimport { useCurrentTab, CurrentTabProvider } from '../../utils/hooks/useCurrentTab';\nimport { ContentSwitcher } from '../../components/ContentSwitcher';\nimport { useComponentDidMount } from '../../utils/hooks/useComponentDidMount';\nimport { useEffect, useState } from 'react';\nimport { useResizeCallback } from '../../utils/hooks/useResizeCallback';\nimport ProjectDetailItem from '../../components/Projects/ProjectDetail';\nimport Profile from '../../components/Profile';\nimport Projects from '../../components/Projects';\nconst DESIGN_WIDTH = 1920;\nconst COMMON_STATIC_PATH = '/static/images/projectDetails/img';\nconst Info = {\n  title: 'Bamboo Stool',\n  desc: ['an exploration of bamboo craft', 'in modern aesthetic'],\n  tags: ['Stool Design | Bamboo Craft | Personal Work in 4 weeks | Dec 2016 '],\n  mainColor: '#587C62',\n  details: 'Bamboo Stool is composed of three groups of repeating raw bamboo strips, exploring the aesthetics of bamboo’s physical properties. To keep the balance between aethetics of raw bamboo strips and the function of load-bearing, I created the special structure of the stool. The three stool legs and the upper surface formed two symmetrical triangles, and every bamboo strip is heated and bent to be crossed or connected with each other. During the handmaking process, Bamboo Stool only requires the same group of mould, according to the construction rule. And I tested di\u001ferent heating temperature, mould sizes and assembly\\n' + 'methods to suit raw bamboo strip’s properties.',\n  images: [{\n    src: COMMON_STATIC_PATH + '2.jpg',\n    sources: [{\n      src: COMMON_STATIC_PATH + '2.webp',\n      type: 'image/webp'\n    }],\n    preview_src: COMMON_STATIC_PATH + '2-preview.jpg',\n    preview_sources: [{\n      src: COMMON_STATIC_PATH + '2-preview.webp',\n      type: 'image/webp'\n    }],\n    alt: 'String board'\n  }],\n  detail_images_meta: {\n    dir: '/static/images/projectDetails/bamboo-stool',\n    num: 4\n  }\n};\nconst menuItems = [{\n  key: 'Bamboo Stool',\n  label: 'Bamboo Stool'\n}];\n\nconst InnerLayout = () => {\n  const {\n    state: {\n      scale: {\n        scale\n      }\n    },\n    actions: {\n      setScale,\n      setCurrentTab\n    }\n  } = useCurrentTab();\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n\n  const fallBackReactive = () => {\n    setScale(1);\n    const scale = Math.min(document.body.clientWidth / 1920, 1);\n    let metaEl = document.querySelector('meta[name=\"viewport\"]');\n\n    if (!metaEl) {\n      metaEl = document.createElement('meta');\n      metaEl.setAttribute('name', 'viewport');\n      metaEl.setAttribute('content', 'width=device-width, initial-scale=' + scale + ', maximum-scale=' + scale + ', minimum-scale=' + scale + ', user-scalable=no');\n      document.documentElement.firstElementChild.appendChild(metaEl);\n    } else {\n      metaEl.setAttribute('content', 'width=device-width, initial-scale=' + scale + ', maximum-scale=' + scale + ', minimum-scale=' + scale + ', user-scalable=no');\n    }\n\n    window.scrollTo({\n      top: 0\n    });\n  }; // innerWidth 比 body.offsetWidth 稳定\n\n\n  const {\n    IsDone\n  } = useComponentDidMount(() => {\n    setCurrentTab(1);\n\n    if (window.innerWidth >= 700) {\n      const scale = Math.max(Math.min(window.innerWidth / DESIGN_WIDTH, 1), 0.2);\n      setScale(scale);\n    } else {\n      fallBackReactive();\n    }\n\n    addCallback(() => {\n      const scale = Math.max(Math.min(window.innerWidth / DESIGN_WIDTH, 1), 0.2);\n      document.getElementsByTagName('html')[0].style.fontSize = `${scale}px`;\n      window.scrollTo({\n        top: 0\n      });\n      setScale(scale);\n    });\n  });\n  useEffect(() => {\n    setIsLoading(true);\n    document.getElementsByTagName('html')[0].style.fontSize = `${scale}px`;\n    window.scrollTo({\n      top: 0\n    }); // 强行将这次setState推迟到下次处理\n\n    setTimeout(() => {\n      setIsLoading(false);\n    }, 0);\n  }, [scale]);\n  const {\n    addCallback\n  } = useResizeCallback(fallBackReactive);\n  return IsDone && !isLoading ? __jsx(\"div\", {\n    className: styles.layout\n  }, __jsx(LayoutHeader, {\n    menuItems: menuItems\n  }), __jsx(ContentSwitcher, null, __jsx(Profile, null), __jsx(ProjectDetailItem, Info), __jsx(Projects, null)), __jsx(LayoutHeader, {\n    menuItems: menuItems,\n    bodyStyle: {\n      marginTop: '138rem'\n    }\n  })) : null;\n};\n\nconst Layout = () => {\n  return __jsx(CurrentTabProvider, null, __jsx(InnerLayout, null));\n};\n\nexport default Layout;","map":null,"metadata":{},"sourceType":"module"}