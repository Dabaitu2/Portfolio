{"ast":null,"code":"var __jsx = React.createElement;\nimport * as React from 'react';\nimport styles from '../index.less';\nimport LayoutHeader from '../../components/LayoutHeader';\nimport { useCurrentTab, CurrentTabProvider } from '../../utils/hooks/useCurrentTab';\nimport { ContentSwitcher } from '../../components/ContentSwitcher';\nimport { useComponentDidMount } from '../../utils/hooks/useComponentDidMount';\nimport { useEffect, useState } from 'react';\nimport { useResizeCallback } from '../../utils/hooks/useResizeCallback';\nimport ProjectDetailItem from '../../components/Projects/ProjectDetail';\nimport Profile from '../../components/Profile';\nimport Projects from '../../components/Projects';\nconst DESIGN_WIDTH = 1920;\nconst COMMON_STATIC_PATH = '/static/images/projectDetails/img';\nconst Info = {\n  title: 'EMO',\n  desc: ['a programming education robot and', 'an online education platform'],\n  tags: ['Integrated Product Development | STEAM Education Service Design | Team Work in 8 weeks | Oct 2017 '],\n  mainColor: '#304690',\n  details: \"EMO is an educational robot, applying applies Arduino to teach children aged 6-12 to learn programming and robot assembly, in order to stimulate creativity and prepare for advanced education. EMO's name comes from emotion. We hope that children could build up emotional connection with EMO robot. EMO has a pleasing appearance with two big eyes and a clear, easy-to-assemble internal structure. In addition to the physical model, we also created an online platform, in order to improve teaching efficiency and parental involvement. The physical robot and the online platform together form a sustainable STEAM education system that provides better services for  studens, teachers and parents.\",\n  images: [{\n    src: COMMON_STATIC_PATH + '4.jpg',\n    sources: [{\n      src: COMMON_STATIC_PATH + '4.webp',\n      type: 'image/webp'\n    }],\n    preview_src: COMMON_STATIC_PATH + '4-preview.jpg',\n    preview_sources: [{\n      src: COMMON_STATIC_PATH + '4-preview.webp',\n      type: 'image/webp'\n    }],\n    alt: 'EMO'\n  }],\n  detail_images_meta: {\n    dir: '/static/images/projectDetails/emo',\n    num: 7\n  }\n};\nconst menuItems = [{\n  key: 'EMO',\n  label: 'EMO'\n}];\n\nconst InnerLayout = () => {\n  const {\n    state: {\n      scale: {\n        scale\n      }\n    },\n    actions: {\n      setScale,\n      setCurrentTab\n    }\n  } = useCurrentTab();\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n\n  const fallBackReactive = () => {\n    setScale(1);\n    const scale = Math.min(document.body.clientWidth / 1920, 1);\n    let metaEl = document.querySelector('meta[name=\"viewport\"]');\n\n    if (!metaEl) {\n      metaEl = document.createElement('meta');\n      metaEl.setAttribute('name', 'viewport');\n      metaEl.setAttribute('content', 'width=device-width, initial-scale=' + scale + ', maximum-scale=' + scale + ', minimum-scale=' + scale + ', user-scalable=no');\n      document.documentElement.firstElementChild.appendChild(metaEl);\n    } else {\n      metaEl.setAttribute('content', 'width=device-width, initial-scale=' + scale + ', maximum-scale=' + scale + ', minimum-scale=' + scale + ', user-scalable=no');\n    }\n\n    window.scrollTo({\n      top: 0\n    });\n  }; // innerWidth 比 body.offsetWidth 稳定\n\n\n  const {\n    IsDone\n  } = useComponentDidMount(() => {\n    setCurrentTab(1);\n\n    if (window.innerWidth >= 700) {\n      const scale = Math.max(Math.min(window.innerWidth / DESIGN_WIDTH, 1), 0.2);\n      setScale(scale);\n    } else {\n      fallBackReactive();\n    }\n\n    addCallback(() => {\n      const scale = Math.max(Math.min(window.innerWidth / DESIGN_WIDTH, 1), 0.2);\n      document.getElementsByTagName('html')[0].style.fontSize = `${scale}px`;\n      window.scrollTo({\n        top: 0\n      });\n      setScale(scale);\n    });\n  });\n  useEffect(() => {\n    setIsLoading(true);\n    document.getElementsByTagName('html')[0].style.fontSize = `${scale}px`;\n    window.scrollTo({\n      top: 0\n    }); // 强行将这次setState推迟到下次处理\n\n    setTimeout(() => {\n      setIsLoading(false);\n    }, 0);\n  }, [scale]);\n  const {\n    addCallback\n  } = useResizeCallback(fallBackReactive);\n  return IsDone && !isLoading ? __jsx(\"div\", {\n    className: styles.layout\n  }, __jsx(LayoutHeader, {\n    menuItems: menuItems\n  }), __jsx(ContentSwitcher, null, __jsx(Profile, null), __jsx(ProjectDetailItem, Info), __jsx(Projects, null)), __jsx(LayoutHeader, {\n    menuItems: menuItems,\n    bodyStyle: {\n      marginTop: '138rem'\n    }\n  })) : null;\n};\n\nconst Layout = () => {\n  return __jsx(CurrentTabProvider, null, __jsx(InnerLayout, null));\n};\n\nexport default Layout;","map":null,"metadata":{},"sourceType":"module"}